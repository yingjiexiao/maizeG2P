# Simulation One: Evaluation of GWAS Accuracy at the Six Levels of Phenotype Prediction Accuracy
1. To quantitatively evaluate GWAS accuracy in terms of both false discovery rate (FDR) and detection power (DP), a series of simulation analyses were conducted. Based on the actual genotypes from the 4.5 million SNPs in the CUBIC population, we randomly selected a set of 100,000 SNPs for simulations. Assuming a polygenic trait is determined by 20 QTNs (Quantitative Trait Nucleotides) contributing effects following an exponential distribution, the 20 QTN effects were expressed as β_i=〖0.96〗^i where i = 1, 2, 3, …, 20 (Yu et al., 2008). From 100,000 SNPs, the 20 QTNs were spiked into a set of randomly selected SNPs (0.25 ≤ MAF ≤ 0.35). 
2. We first simulated the observed phenotype of one sample by summing the 20 QTNs’ contribution expressed as y=∑_(i=1)^20▒〖x_i β_i 〗 where x_i and β_i are the numeric genotypic values and simulated QTN effects at the ith QTN, respectively. Contribution of each QTN was further represented by a value of PVE (Phenotypic Variance Explained) expressed as PVE=βf(1-f) where β is the QTN effect and f is allelic frequency in the 1,428 samples. Based on PVEs, the 20 QTNs were categorized into three classes of QTNs with major (4 QTNs, PVE ≥ 7%), moderate (6 QTNs, 4.5% ≤ PVE < 7%) and minor (10 QTNs, PVE < 4.5%) contributing effects. 
3. Then, we simulated the predicted phenotypes with six levels of prediction accuracy, so that the correlation between GWAS and G2P accuracies may be established. Simulation of predicted phenotype was based on the equation of y^'=y+ε where y is the simulated observed phenotype and ε is the residual representing the fluctuated prediction bias assumed following a normal distribution expressed as N(0,(σ_y^2 (1-r^2 ))⁄r^2 ) where r^2 is the squared correlation coefficient between the observed and predicted phenotypes. Thus, quantitative evaluation of FDR and DP of GWAS under six levels of prediction accuracy (r^2=1.0, 0.8, 0.6, 0.4, 0.2 and 0.1) may be carried out. Because GWAS power is also influenced by population size, each simulation was performed for six times, using five randomized subsets (207, 400, 600, 800 and 1000 samples) out of the 1428 samples as well as the complete set. Then, 36 combinations of population size and prediction accuracy were set for one round of simulation and each round was repeated for 500 times to obtain averaged results of FDR and DP. During each time of repeat, a new set of 20 QTNs and predicted phenotypes with randomized residuals were generated. Finally, the whole simulation process generated a total of 18,000 sets of GWAS results for computing averaged FDR and DP under the six different circumstances of population size and prediction accuracy. 

# Simulation Two: Correlation Between Population Size and GWAS Detection Power Using a Spike-in QTN under different genetic structures
1. To demonstrate that any enhancement of GWAS detection power using 1,428 samples can be attributed to the enlarged population size compared to that of 207 samples, we conducted a simulation analysis to determine the correlation between population size and GWAS detection power. The GWAS simulation was conducted following a previously published procedure (Zhang et al., 2010). 
2. In this procedure, one SNP (0.25 ≤ MAF ≤ 0.35) was randomly picked from the ~4.5 million SNPs, and a spike-in QTN (Quantitative Trait Nucleotide) effect was assigned to this SNP; The QTN effect is a designated coefficient of the standard deviation (SD) of the actual phenotypic distribution of Zheng58 F1 hybrids, in which 19 gradients of QTN effects ranging from 0.1 to 1.9 with a step of 0.1 were used for each round of simulation. Based on the genotypes (two alleles, e.g., AA and AG corresponding to high and low phenotypes, respectively) of the chosen SNP among Zheng58 F1 hybrids, the original phenotype was transformed to a simulated phenotype, calculated using the original phenotype of the AA hybrids + (QTN effect × SD) and AG hybrids – (QTN effect × SD). Under each QTN effect gradient, we randomly picked 100 SNPs to generate 100 simulated phenotypic distributions for the Zheng58 F1 hybrids. Next, we performed GWAS 100 times using the 100 sets of simulated phenotypes for the Zheng58 F1 hybrids. Using a p value =2.2×1e-7 as the significance cutoff, we counted the number of significant SNPs (n) out of the 100 SNPs passing the cutoff and used the corresponding percentage (n/100) to represent the GWAS detection power. For each trait, we repeated the above procedure 19 times using the 19 QTN effect gradients to generate GWAS detection power predictions on the 207 and 1,428 samples for a comparison. Finally, we conducted a simulation for effect and sample sizes that impact on the GWAS detection power under the genetic architectures of three real traits: DTT, PH and EW in both measured and predicted phenotypic variations. With this simulation analysis, we deduced that a significant QTN with an effect of 0.4 would be detected using 1,428 samples, while using 207 samples the QTN effect would have to be over 1.2 to be detected.




